<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Formulário de Relatório de Visitas</title>
    <style>
        .required:after {
            content: " *";
            color: red;
        }
        .content {
            margin-bottom: 10px;
        }
        /* Classe para destacar campos com erro */
        .error-border {
            border: 2px solid red;
        }
        body
        { 
           
            font-family: Arial, sans-serif;
        }
        .header {
            background-color: #002A6B;
            color: white;
            display: flex;
            justify-content: space-evenly;
            align-items: center;
            padding: 10px 20px;
        }
        .header h1 {
            margin: 10px;
            font-size: 24px;
        }
        .header img {
            height: 60px;
        }
        {
            font-family: Arial, sans-serif;
            margin: 20px;
            background-color: #002A6B;
        }

        .section {
            margin-bottom: 10px;
        }

        .section-title {
            font-weight: bold;
            margin-bottom: 5px;
        }

        .content {
            width: calc(50% - 10px);
            padding: 5px;
            margin-bottom: 10px;
            border: 1px solid #ccc;
            border-radius: 4px;
            display: inline-block;
        }
        .content1 {
            width: calc(24% - 5px);
            padding: 5px;
            margin-bottom: 5px;
            border: 1px solid #ccc;
            border-radius: 4px;
            display: inline-block;
        }

        .full-width {
            width: 100%;
        }

        .container {
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
            border-radius: 8px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        }

        h2 {
            background-color: #002A6B;
            color: white;
            padding: 10px;
            border-radius: 4px;
            text-align: center;
        }
        
        /* Estilo dos botões */
        .buttons {
            margin-top: 20px;
        }

        .buttons button {
            padding: 10px 20px;
            font-size: 16px;
            background-color: #002A6B;
            color: white;
            border-radius: 8px;
            cursor: pointer;
            display: flex;
            justify-content: center;
            margin: 60px 0px
        }

        .buttons button:hover {
            background-color: #002A6B;
        }

        /* Estilos de impressão */
        @media print {
            .header {
                background-color: #002A6B !important;
                color: white !important;
            }

            .buttons {
                display: none; /* Oculta os botões de ação na impressão */
            }

            input {
                border-color: black; /* Garante que os campos tenham uma borda visível na impressão */
            }
            /* Manter as cores do conteúdo */
            body, .header, input {
                -webkit-print-color-adjust: exact;
                color-adjust: exact;
            }
        }
        .footer {
            background-color: #002E6D; /* Mesmo fundo azul do título */
            color: white;
            text-align: center;
            padding: 5px 0;
            position: fixed;
            bottom: 0;
            width: 100%;
            left: 0;
            right: 0;
            z-index: 100;
            font-size: 12px;
        }
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>RELATÓRIO DE VISITAS</h1>
        <a href="URL_DO_LOGO" target="_blank">
            <img src="Imagem1.png" alt="Logo BS FIDC">
        </a>
    </div>

        <!-- Etapa 1: Informações Básicas -->
            <div class="container">
                <h2>Informações Básicas</h2>

                <div class="section">
                    <label for="CNPJ" class="section-title required">CNPJ:</label>
                    <input type="text" id="cnpj" class="content" placeholder="Digite o CNPJ">
                    <!-- Botão para realizar a consulta -->
                <button type="button" onclick="consultarCNPJ()" style="background-color: #002A6B; color: white; padding: 10px 20px; border: none; cursor: pointer; border-radius: 8px;">Consultar CNPJ</button>
                </div>

                <div class="section">
                    <label for="nome" class="section-title required">Nome:</label>
                    <input type="text" id="nome" class="content" placeholder="Digite o nome">
                </div>

                <div class="section">
                    <label for="endereco" class="section-title required">Endereço:</label>
                    <input type="text" id="endereco" class="content" placeholder="Digite o endereço">
                </div>

                <div class="section">
                    <label for="telefone" class="section-title required">Telefone:</label>
                    <input type="tel" id="telefone" class="content1" placeholder="Digite o telefone">
                </div>

                <div class="section">
                    <label for="email" class="section-title required">Email:</label>
                    <input type="email" id="email" class="content" placeholder="Digite o email">
                </div>

                <div class="section">
                    <label for="cep" class="section-title required">CEP:</label>
                    <input type="text" id="cep" class="content1" placeholder="Digite o CEP">
                </div>

                <div class="section">
                    <label for="situacao_cadastral" class="section-title required">Situação Cadastral:</label>
                    <input type="text" id="situacao_cadastral" class="content1" placeholder="Digite a situação cadastral">
                </div>

                <div class="section">
                    <label for="data_abertura" class="section-title required">Data de Abertura:</label>
                    <input type="text" id="data_abertura" class="content1" placeholder="Digite a data de abertura">
                </div>

        <div class="section">
            <label for="data_visita" class="section-title required">Data da Visita:</label>
            <input type="date" id="data_visita" class="content1">
        </div>
        <div class="section">
            <label for="local_visita" class="section-title required">Local da Visita:</label>
            <input type="text" id="local_visita" class="content" placeholder="Digite o local da visita">
        </div>
        <div class="section">
            <label for="visita_realizada_por" class="section-title required">Visita Realizada Por:</label>
            <input type="text" id="visita_realizada_por" class="content" placeholder="Digite o nome do responsável">
        </div>
        <div class="section">
            <label for="origem_relacionamento" class="section-title required">Origem Relacionamento:</label>
            <input type="text" id="origem_relacionamento" class="content" placeholder="Digite a origem do relacionamento">
        </div>


                <!-- Inclusão do jQuery -->
                <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
                <script>
                    function formatarCNPJ(cnpj) {
                        // Remover todos os caracteres não numéricos
                        var cnpjLimpo = cnpj.replace(/[^\d]/g, '');

                        // Formatar o CNPJ com máscara
                        return cnpjLimpo.replace(/^(\d{2})(\d{3})(\d{3})(\d{4})(\d{2})$/, "$1.$2.$3/$4-$5");
                    }

                    function consultarCNPJ() {
                        var cnpj = document.getElementById("cnpj").value;
                        var cnpjFormatado = formatarCNPJ(cnpj); // Formatar o CNPJ

                        if (cnpjFormatado.length !== 18) { // Verificação para CNPJ com a máscara
                            alert("CNPJ inválido! Por favor, verifique o número digitado.");
                            return;
                        }

                        $.ajax({
                            url: "https://www.receitaws.com.br/v1/cnpj/" + cnpjFormatado.replace(/[^\d]/g, ''), // Remover máscara para a consulta
                            type: "GET",
                            dataType: "jsonp",
                            success: function (data) {
                                // Dados da empresa
                                var nome = data.nome;
                                var endereco = data.logradouro + ", " + data.numero + " - " + data.bairro + ", " + data.municipio + " - " + data.uf;
                                var telefone = data.telefone;
                                var email = data.email;
                                var cep = data.cep;
                                var situacaoCadastral = data.situacao;
                                var dataAbertura = data.abertura;

                                // Atualizar campos do formulário
                                document.getElementById("nome").value = nome;
                                document.getElementById("endereco").value = endereco;
                                document.getElementById("telefone").value = telefone;
                                document.getElementById("email").value = email;
                                document.getElementById("cep").value = cep;
                                document.getElementById("situacao_cadastral").value = situacaoCadastral;
                                document.getElementById("data_abertura").value = dataAbertura;

                                // Atualizar o campo de CNPJ com a máscara formatada
                                document.getElementById("cnpj").value = cnpjFormatado;
                            },
                            error: function (error) {
                                console.log(error);
                                alert("Erro ao consultar CNPJ!");
                            }
                        });
                    }
                </script>

        <!-- Etapa 2 -->
            <h2>Dados da Empresa</h2>

            <div class="section">
                <label for="nome_fantasia" class="section-title ">Nome Fantasia:</label>
                <input type="text" id="nome_fantasia" class="content1" placeholder="Digite o nome fantasia">
            </div>
            <div class="section">
                <label for="site_empresa" class="section-title required">Site da Empresa:</label>
                <input type="url" id="site_empresa" class="content1" placeholder="Digite o site da empresa">
            </div>
            <div class="section">
                <label for="tempo_atividade" class="section-title required">Tempo em Atividade:</label>
                <select id="tempo_atividade" class="content1">
                    <option value="">Selecione</option>
                    <option value="Menos de 1 ano">Menos de 1 ano</option>
                    <option value="1 a 5 anos">1 a 5 anos</option>
                    <option value="6 a 10 anos">6 a 10 anos</option>
                    <option value="11 a 15 anos">11 a 15 anos</option>
                    <option value="16 a 20 anos">16 a 20 anos</option>
                    <option value="Mais de 21 anos">Mais de 21 anos</option>
                </select>

                <label for="market_share" class="section-title required">Market Share?</label>
                <select id="market_share" class="content1">
                    <option value="">Selecione</option>
                    <option value="ENTRE 31% A 40%">ENTRE 31% A 40%</option>
                    <option value="ENTRE 41% A 50%">ENTRE 31% A 40%</option>
                    <option value="ENTRE 51% A 60%">ENTRE 31% A 40%</option>
                    <option value="ENTRE 61% A 70%">ENTRE 31% A 40%</option>
                    <option value="ENTRE 71% A 80%">ENTRE 31% A 40%</option>
                    <option value="ENTRE 81% A 90%">ENTRE 31% A 40%</option>
                    <option value="ACIMA DE 91%">ACIMA DE 91%</option>
                    
                </select>
            </div>
            <div class="section full-width">
                <label for="atividade_principal" class="section-title required">Atividade Principal / Principais Produtos Fornecidos ou Serviços Prestados:</label>
                <textarea id="atividade_principal" class="content full-width" placeholder="Descreva a atividade principal"></textarea>
            </div>
                <div class="section">
                    <label for="ciclo_operacional" class="section-title required">Ciclo Operacional:</label>
                    <input type="text" id="ciclo_operacional" class="content1" placeholder="Digite o prazo em dias">
                <label for="prazo_medio_estocagem" class="section-title required">Prazo Médio de Estocagem:</label>
                <input type="text" id="prazo_medio_estocagem" class="content1" placeholder="Digite o prazo médio de estocagem">
            </div>
            <div class="section">
                <label for="capacidade_produtiva" class="section-title required">Capacidade Produtiva:</label>
                <select id="capacidade_produtiva" class="content1">
                    <option value="">Selecione</option>
                    <option value="ABAIXO DE 50%">ABAIXO DE 50%</option>
                    <option value="ENTRE 51% A 70%">ENTRE 51% A 70%</option>
                    <option value="ENTRE 71% A 80%">ENTRE 71% A 80%</option>
                    <option value="ENTRE 81% A 90%">ENTRE 81% A 90%</option>
                    <option value="ACIMA DE 90%">ACIMA DE 90%</option>
                </select>

                <label for="margem_liquida" class="section-title ">Margem Líquida:</label>
                <input type="text" id="margem_liquida" class="content1" placeholder="Digite a margem líquida">
            </div>
            <div class="section">
                <label for="instalacoes" class="section-title required">Instalações:</label>
                <select id="instalacoes" class="content1">
                    <option value="">Selecione</option>
                    <option value="Próprias">Próprias</option>
                    <option value="Alugadas">Alugadas</option>
                </select>

                <label for="valor_locacao" class="section-title ">Valor da Locação (R$):</label>
                <input type="text" id="valor_locacao" class="content1" placeholder="Digite o valor da locação em R$">
            </div>
            <div class="section">
                <label for="turnos" class="section-title required">Turnos:</label>
                <select id="turnos" class="content1">
                    <option value="">Selecione</option>
                    <option value="1">1</option>
                    <option value="2">2</option>
                    <option value="3">3</option>
                </select>
                <label for="quantidade_colaboradores" class="section-title required">Quantidade de Colaboradores:</label>
                <input type="text" id="quantidade_colaboradores" class="content1" placeholder="Digite a quantidade de colaboradores">
            </div>
            <div class="section">
                <label for="valor_folha" class="section-title ">Valor da Folha de Pagamento (R$):</label>
                <input type="text" id="valor_folha" class="content1" placeholder="Digite o valor da folha de pagamento em R$">

                <label for="filiais_ativas" class="section-title required">Filiais com Produção Ativa:</label>
                <select id="filiais_ativas" class="content1">
                    <option value="">Selecione</option>
                    <option value="Sim">Sim</option>
                    <option value="Não">Não</option>
                </select>
                <div class="section">
                        <label for="possui_consultoria" class="section-title required">Possui Consultoria:</label>
                        <select id="possui_consultoria" class="content1" onchange="verificarConsultoria()">
                            <option value="">Selecione</option>
                            <option value="Sim">Sim</option>
                            <option value="Não">Não</option>
                        </select>
                    </div>

                    <div class="section">
                        <label for="consultoria_qual" class="section-title required">Qual?</label>
                        <input type="text" id="consultoria_qual" class="content1" placeholder="Digite a consultoria, se houver" disabled>
                    </div>

                    <div class="section">
                        <label for="data_entrada_consultoria" class="section-title required">Data de Entrada Consultoria:</label>
                        <input type="date" id="data_entrada_consultoria" class="content1" disabled>

                        <label for="tempo_contrato" class="section-title required">Tempo de Contrato:</label>
                        <input type="text" id="tempo_contrato" class="content1" placeholder="Digite o tempo de contrato" disabled>
                    </div>
                </div>
                <script>
                    function verificarConsultoria() {
                        var possuiConsultoria = document.getElementById("possui_consultoria").value;
                        var camposObrigatorios = ["consultoria_qual", "data_entrada_consultoria", "tempo_contrato"];

                        if (possuiConsultoria === "Sim") {
                            camposObrigatorios.forEach(function(campoId) {
                                document.getElementById(campoId).disabled = false;
                                document.getElementById(campoId).setAttribute("required", "required");
                            });
                        } else {
                            camposObrigatorios.forEach(function(campoId) {
                                document.getElementById(campoId).disabled = true;
                                document.getElementById(campoId).removeAttribute("required");
                                document.getElementById(campoId).value = ""; // Limpar o valor se estiver desabilitado
                            });
                        }
                    }
                </script>
        
        
        <!-- Etapa 3: Administração -->
        <h2>Administração</h2>
        <div class="section">
            <label for="socios_direito" class="section-title required">Sócios Contrato Social (Sócios de Direito) - E Suas Experiências / Know-How (Quadro Abaixo):</label>
            <textarea id="socios_direito" class="content full-width" placeholder="Detalhe as experiências e know-how dos sócios de direito"></textarea>
        </div>
        <div class="section">
            <label for="socios_fato" class="section-title required">Sócios que NÃO Constam no Contrato Social (Sócios de Fato) - Experiências / Know-How (Quadro Abaixo):</label>
            <textarea id="socios_fato" class="content full-width" placeholder="Detalhe as experiências e know-how dos sócios de fato"></textarea>
        </div>
        <div class="section">
            <label for="tempo_gestao" class="section-title required">Há Quanto Tempo Sócios Estão na Gestão?</label>
            <input type="text" id="tempo_gestao" class="content" placeholder="Digite o tempo de gestão dos sócios">
        </div>
        <div class="section">
            <label for="ligacao_socios" class="section-title required">Se Mais de Um Sócio, Qual a Ligação Entre Eles?</label>
            <input type="text" id="ligacao_socios" class="content" placeholder="Detalhe a ligação entre os sócios">
        </div>
        <div class="section">
            <label for="processos_sucessao" class="section-title required">Já Iniciaram Processos de Sucessão?</label>
            <select id="processos_sucessao" class="content">
                <option value="">Selecione</option>
                <option value="Sim">Sim</option>
                <option value="Não">Não</option>
            </select>
        </div>
        <div class="section">
            <label for="tipo_administracao" class="section-title required">Tipo de Administração?</label>
            <select id="tipo_administracao" class="content">
                <option value="">Selecione</option>
                <option value="Familiar">Familiar</option>
                <option value="Profissionalizada">Profissionalizada</option>
                <option value="Mista">Mista</option>
                <option value="Outros">Outros</option>
            </select>
        </div>


        
        <!-- Etapa 4: Fornecedores -->
        <h2>Fornecedores</h2>
        <div class="section">
            <label class="section-title">Identifique abaixo os 5 principais fornecedores:</label>

            <!-- Fornecedor 1 -->
            <div class="section">
            <label for="Fonecedor 1" class="section-title required">Fornecedor 1</label>
            <div class="fornecedor-row">
                <input type="text" id="fornecedor1_nome" class="content required" placeholder="Fornecedor 1 - Nome / CNPJ">
                <input type="text" id="fornecedor1_dependencia" class="content required" placeholder="Dependência (%)">
                <input type="text" id="fornecedor1_prazo_pgto" class="content required" placeholder="Prazo Pgto.">
                <input type="text" id="fornecedor1_insumo" class="content required" placeholder="Principal Insumo">
            </div>

            <!-- Fornecedor 2 -->
                <div class="section">
                    <label for="Fonecedor 2" class="section-title required">Fornecedor 2</label>
            <div class="fornecedor-row">
                <input type="text" id="fornecedor2_nome" class="content required" placeholder="Fornecedor 2 - Nome / CNPJ">
                <input type="text" id="fornecedor2_dependencia" class="content required" placeholder="Dependência (%)">
                <input type="text" id="fornecedor2_prazo_pgto" class="content required" placeholder="Prazo Pgto.">
                <input type="text" id="fornecedor2_insumo" class="content required" placeholder="Principal Insumo">
            </div>

            <!-- Fornecedor 3 -->
            <div class="section">
                 <label for="Fonecedor 3" class="section-title required">Fornecedor 3</label>
            <div class="fornecedor-row">
                <input type="text" id="fornecedor3_nome" class="content required" placeholder="Fornecedor 3 - Nome / CNPJ">
                <input type="text" id="fornecedor3_dependencia" class="content required" placeholder="Dependência (%)">
                <input type="text" id="fornecedor3_prazo_pgto" class="content required" placeholder="Prazo Pgto.">
                <input type="text" id="fornecedor3_insumo" class="content required" placeholder="Principal Insumo">
            </div>


        <!-- Etapa 5: Clientes -->
        <h2>Clientes</h2>
        <div class="section">
            <label class="section-title required">Anexar na POC, Curva ABC de clientes, especificando razão social, CNPJ, e representatividade sobre o faturamento (% percentual)</label>

            <div class="section-subtitle">
                <div class="left">
                    <label class="required" for="ticket_medio">Ticket Médio?</label>
                    <input type="text" id="ticket_medio" class="content1" placeholder="Ticket Médio">
                </div>
                <div class="right">
                    <label class="required" for="prz_medio_recebimento">PRZ Médio Recebimento</label>
                    <input type="text" id="prz_medio_recebimento" class="content1" placeholder="PRZ Médio Recebimento">
                    <label class="required" for="prz_maximo_recebimento">PRZ Máximo Recebimento</label>
                    <input type="text" id="prz_maximo_recebimento" class="content1" placeholder="PRZ Máximo Recebimento">
                </div>
            </div>

            <div class="section-subtitle">Representatividade por Região e Prazo de Entrega (Informar abaixo o percentual)</div>

            <div class="region-row">
                <div class="region-column">
                    <label class="required" for="sudeste_prz_entrega">Sudeste</label>
                    <input type="text" id="sudeste_prz_entrega" class="content1" placeholder="PRZ Entrega">
                </div>
                <div class="region-column">
                    <label class="required" for="centro_oeste_prz_entrega">Centro-Oeste</label>
                    <input type="text" id="centro_oeste_prz_entrega" class="content1" placeholder="PRZ Entrega">
                </div>
                <div class="region-column">
                    <label class="required" for="sul_prz_entrega">Sul</label>
                    <input type="text" id="sul_prz_entrega" class="content1" placeholder="PRZ Entrega">
                </div>
                <div class="region-column">
                    <label class="required" for="norte_prz_entrega">Norte</label>
                    <input type="text" id="norte_prz_entrega" class="content1" placeholder="PRZ Entrega">
                </div>
                <div class="region-column">
                    <label class="required" for="nordeste_prz_entrega">Nordeste</label>
                    <input type="text" id="nordeste_prz_entrega" class="content1" placeholder="PRZ Entrega">
                </div>
            </div>
            
                <div class="section">
                    <label for="necessario_aprovacao" class="section-title required">Será necessário aprovar concentração em algum sacado? Se positivo, especificar abaixo:</label>
                    <select id="necessario_aprovacao" class="content1" onchange="verificarAprovacaoConcentracao()">
                        <option value="">Selecione</option>
                        <option value="Sim">Sim</option>
                        <option value="Não">Não</option>
                    </select>
                </div>

                <div class="approval-row">
                    <div class="approval-column">
                        <label class="required" for="razao_social">Razão Social / CNPJ / Ou Grupo</label>
                        <input type="text" id="razao_social" class="content" placeholder="Razão Social / CNPJ / Grupo" disabled>
                    </div>
                    <div class="approval-column">
                        <label class="required" for="limite_pleiteado">Limite Pleiteado</label>
                        <input type="text" id="limite_pleiteado" class="content1" placeholder="Limite Pleiteado" disabled>
                    </div>
                    <div class="approval-column">
                        <label class="required" for="pmrv">PMRV</label>
                        <input type="text" id="pmrv" class="content1" placeholder="PMRV" disabled>
                    </div>
                    <div class="approval-column">
                        <label class="required" for="forma_pagamento">Forma de Pagamento</label>
                        <input type="text" id="forma_pagamento" class="content1" placeholder="Forma de Pagamento" disabled>
                    </div>
                </div>

                <script>
                    function verificarAprovacaoConcentracao() {
                        var necessarioAprovacao = document.getElementById("necessario_aprovacao").value;
                        var camposObrigatorios = ["razao_social", "limite_pleiteado", "pmrv", "forma_pagamento"];

                        if (necessarioAprovacao === "Sim") {
                            camposObrigatorios.forEach(function(campoId) {
                                document.getElementById(campoId).disabled = false;
                                document.getElementById(campoId).setAttribute("required", "required");
                            });
                        } else {
                            camposObrigatorios.forEach(function(campoId) {
                                document.getElementById(campoId).disabled = true;
                                document.getElementById(campoId).removeAttribute("required");
                                document.getElementById(campoId).value = ""; // Limpar o valor se estiver desabilitado
                            });
                        }
                    }
                </script>

        <h2>Dívida Tributária</h2>
        <div class="section">
            <div class="section-row">
                <label class="required" for="divida_aberto">Possui Dívida Tributária em Aberto?</label>
                <select id="divida_aberto" class="content1">
                    <option value="">Selecione</option>
                    <option value="sim">Sim</option>
                    <option value="nao">Não</option>
                </select>
            </div>

            <div class="section-row">
                <label class="required" for="valor_divida">Valor?</label>
                <input type="text" id="valor_divida" class="content1" placeholder="Valor">
            </div>

            <div class="section-row">
                <label class="required" for="fase_negociacao">Caso Possua Dívida Tributária, Está em Fase de Negociação?</label>
                <select id="fase_negociacao" class="content1">
                    <option value="">Selecione</option>
                    <option value="sim">Sim</option>
                    <option value="nao">Não</option>
                </select>
            </div>

            <div class="section-row">
                <label class="required" for="possibilidade_penhora">Caso Ainda Não Esteja Renegociada, Há Possibilidade de Penhora Sobre o Faturamento?</label>
                <select id="possibilidade_penhora" class="content1">
                    <option value="">Selecione</option>
                    <option value="sim">Sim</option>
                    <option value="nao">Não</option>
                </select>
            </div>
        </div>


        <!-- Etapa 7: Faturamento / Formas de Recebimento -->
        <h2>Faturamento / Formas de Recebimento</h2>
            <div class="section">
                <div class="section-row">
                    <label class="required" for="sazonalidade">Há Sazonalidade nas Vendas?</label>
                    <select id="sazonalidade" class="content1" onchange="verificarSazonalidade()">
                        <option value="">Selecione</option>
                        <option value="sim">Sim</option>
                        <option value="nao">Não</option>
                    </select>
                    <label for="periodo_sazonal">Qual Período?</label>
                    <input type="text" id="periodo_sazonal" class="content1" placeholder="Período" disabled>
                </div>
            </div>

            <script>
                function verificarSazonalidade() {
                    var sazonalidade = document.getElementById("sazonalidade").value;
                    var campoPeriodo = document.getElementById("periodo_sazonal");

                    if (sazonalidade === "sim") {
                        campoPeriodo.disabled = false;
                        campoPeriodo.setAttribute("required", "required");
                    } else {
                        campoPeriodo.disabled = true;
                        campoPeriodo.removeAttribute("required");
                        campoPeriodo.value = ""; // Limpar o valor se estiver desabilitado
                    }
                }
            </script>

            <div class="section-row">
                <div class="section-subtitle">Sobre as Vendas, Quanto Representa o Recebimento Através de:</div>
                <div class="recebimento-row">
                    <label class="required" for="boletos">Boletos</label>
                    <input type="text" id="boletos" class="content1" placeholder="Boletos %">
                    <label class="required" for="credito_conta">Crédito em Conta</label>
                    <input type="text" id="credito_conta" class="content1" placeholder="Crédito em Conta%">
                    <label class="required" for="cartao_credito">Cartão de Crédito</label>
                    <input type="text" id="cartao_credito" class="content1" placeholder="Cartão de Crédito%">
                </div>
                <div class="recebimento-row">
                    <label class="required" for="avista">À Vista</label>
                    <input type="text" id="avista" class="content1" placeholder="À Vista">
                    <label for="intercompany">Intercompany</label>
                    <input type="text" id="intercompany" class="content1" placeholder="Intercompany">
                    <label for="exportacao">Exportação</label>
                    <input type="text" id="exportacao" class="content1" placeholder="Exportação">
                </div>
            </div>

            <div class="section-row">
                <label class="required" for="demanda_sacados">Há Demanda para Sacados que Não Aceitam Negociação de Títulos?</label>
                <input type="text" id="demanda_sacados" class="content" placeholder="Sim/Não 
        (se sim qual o valor?)">
            </div>

            <div class="section-row">
                <label class="required" for="negociacao_servico">Haverá Negociação de Notas de Prestação de Serviço?</label>
                <select id="negociacao_servico" class="content1">
                    <option value="">Selecione</option>
                    <option value="sim">Sim</option>
                    <option value="nao">Não</option>
                </select>
            </div>
        </div>


        <!-- Etapa 8: Endividamento com Bancos, Factorings e FIDCs -->
        <h2>Endividamento com Bancos, Factorings e FIDCs</h2>
        <div class="section">
            <div class="section-title required">Anexar na POC, endividamento com bancos e fundos, especificando credor, modalidade, limite, valor utilizado (saldo devedor) e garantia prestada (se houver):</div>

            <!-- Opera somente com bancos? -->
            <div class="section-title required">Opera somente com bancos?</div>
            <div class="section-options">
                <label><input type="radio" name="opera_bancos" value="sim"> Sim</label>
                <label><input type="radio" name="opera_bancos" value="nao"> Não</label>
            </div>

            <!-- Possui operações em FIDCs? -->
            <div class="section-title required">Possui operações em FIDCs?</div>
            <div class="section-options">
                <label><input type="radio" name="opera_fidcs" value="sim"> Sim</label>
                <label><input type="radio" name="opera_fidcs" value="nao"> Não</label>
            </div>

            <!-- Taxa média praticada nos principais parceiros -->
            <div class="section-title required">Taxa média praticada nos principais parceiros:</div>
            <input type="text" id="taxa_media" class="content" placeholder="Taxa Média">

            <!-- Possui alguma particularidade nas operações? -->
            <div class="section-title">Possui alguma particularidade nas operações? (Informar no quadro abaixo)</div>
            <textarea id="particularidades" class="content" placeholder="Descreva aqui as particularidades nas operações"></textarea>
        </div>

        
        
        <!-- Etapa 9: Aspectos / Fatos Relevantes / Particularidades -->
        <h2>Aspectos / Fatos Relevantes / Particularidades</h2>
        <div class="section">
            <div class="section-title">Descreva abaixo os aspectos, fatos relevantes e particularidades:</div>
            <textarea id="aspectos_fatos_particularidades" class="content" placeholder="Preencha aqui os aspectos, fatos relevantes e particularidades"></textarea>
        </div>
        

            <!-- Etapa 10: Dados Operacionais -->
            <h2>Dados Operacionais</h2>
            <div class="section">
                <!-- Regresso das Operações -->
                <div class="section-title required">No que tange ao regresso, as operações serão:</div>
                <div class="section-options">
                    <label><input type="radio" name="regresso_operacoes" value="com_regresso" required> Com Regresso</label>
                    <label><input type="radio" name="regresso_operacoes" value="sem_regresso" required> Sem Regresso</label>
                    <label><input type="radio" name="regresso_operacoes" value="hibrido" required> Híbrido (Ambos)</label>
                </div>

                <!-- Operações realizadas por -->
                <div class="section-title required">As operações serão realizadas por:</div>
                <div class="section-options">
                    <label><input type="radio" name="realizacao_operacoes" value="matriz" required> Opera somente pela matriz</label>
                    <label><input type="radio" name="realizacao_operacoes" value="filial" required> Opera somente pela filial</label>
                    <label><input type="radio" name="realizacao_operacoes" value="matriz_filial" required> Opera pela matriz e filial</label>
                </div>

                <!-- Necessidade de formalizar contrato apartado -->
                <div class="section-title required">Se operar por filial, haverá necessidade de formalizar contrato apartado Matriz/Filial?</div>
                <div class="section-options">
                    <label><input type="radio" name="contrato_apartado" value="sim" required> Sim</label>
                    <label><input type="radio" name="contrato_apartado" value="nao" required> Não</label>
                </div>

                <!-- Devedor Solidário -->
                <div class="section-title required">Quem assinará as operações como devedor solidário? (Informar no quadro abaixo)</div>
                <textarea id="devedor_solidario" class="content required" placeholder="Descreva aqui quem assinará as operações como devedor solidário"></textarea>

                <!-- Performance dos Títulos -->
                <div class="section-title required">Quanto a performance dos títulos no momento da operação:</div>
                <div class="section-options">
                    <label><input type="radio" name="performance_titulos" value="performados" required> Somente títulos performados (entregues)</label>
                    <label><input type="radio" name="performance_titulos" value="em_transito" required> Somente títulos em trânsito</label>
                    <label><input type="radio" name="performance_titulos" value="ambos" required> Títulos performados entregues e em trânsito</label>
                </div>

                <!-- Prazo de Entrega para Mercadoria em Trânsito -->
                <div class="section-title required">Nos casos de op. com mercadoria em trânsito. Qual prazo de entrega?</div>
                <input type="text" id="prazo_entrega_transito" class="content required" placeholder="Informe o prazo de entrega">

                <!-- Checagem após a operação -->
                <div class="section-title required">Quantos dias após a operação, podemos agendar a checagem?</div>
                <input type="text" id="checagem_dias" class="content required" placeholder="Informe a quantidade de dias">

                <!-- Transporte -->
                <div class="section-title required">Os transportes são realizados por?</div>
                <div class="section-options">
                    <label><input type="radio" name="transporte" value="frota_propria" required> Frota Própria</label>
                    <label><input type="radio" name="transporte" value="terceiros" required> Terceiros</label>
                    <label><input type="radio" name="transporte" value="ambos" required> Ambos</label>
                </div>

                <!-- Boletos -->
                <div class="section-title required">Boletos serão:</div>
                <div class="section-options">
                    <label><input type="radio" name="boletos" value="pre_impresso_cedente" required> Pré-impresso pelo cedente</label>
                    <label><input type="radio" name="boletos" value="emitido_fundo_banco" required> Emitido pelo fundo, através de banco</label>
                    <label><input type="radio" name="boletos" value="emitido_fundo_escrow" required> Emitido pelo fundo através de conta Escrow</label>
                </div>

                <!-- Outros -->
                <div class="section-title">Outros:</div>
                <textarea id="outros" class="content" placeholder="Informe outros aspectos relevantes"></textarea>

                <!-- Direcionamento ao Cartório -->
                <div class="section-title required">Os títulos podem ser direcionados ao cartório?</div>
                <div class="section-options">
                    <label><input type="radio" name="direcionamento_cartorio" value="sim" required> Sim</label>
                    <label><input type="radio" name="direcionamento_cartorio" value="nao" required> Não</label>
                </div>

                <!-- Envio ao Cartório após quantos dias -->
                <div class="section-title required">Se positivo, será enviado após quantos dias de vencido?</div>
                <input type="text" id="dias_vencido" class="content required" placeholder="Informe a quantidade de dias">

                <!-- Recompra pelo Cedente -->
                <div class="section-title required">Caso não possa ser enviado a cartório, cedente recompra com quantos dias:</div>
                <input type="text" id="recompra_dias" class="content required" placeholder="Informe a quantidade de dias">

                <!-- Baixa em Banco ou Cobrança Simples -->
                <div class="section-title required">Nos casos de recompra, haverá baixa em banco ou ficará em cobrança simples?</div>
                <input type="text" id="baixa_cobranca" class="content required" placeholder="Informe o procedimento de recompra">

                <!-- Ligação das Notas Vencidas -->
                <div class="section-title required">Podemos realizar ligação das notas vencidas?</div>
                <div class="section-options">
                    <label><input type="radio" name="ligacao_notas_vencidas" value="sim" required> Sim</label>
                    <label><input type="radio" name="ligacao_notas_vencidas" value="nao" required> Não</label>
                </div>
            </div>

        <!-- Etapa 11: Limite Pleiteado / Conclusão -->
        <h2>Limite Pleiteado / Conclusão</h2>
        <div class="section" style="display: flex; flex-wrap: wrap;">

            
            <!-- Coluna 1 -->
            <div class="section-title required" style="flex: 1; margin-right: 20px;">
                <label for="desconto_dp" style="display: inline-block; width: 150px;">Desconto DP?</label>
                <select id="desconto_dp" class="content1" style="width: 200px; display: inline-block;" onchange="verificarDescontoDP()">
                    <option value="">Selecione...</option>
                    <option value="sim">Sim</option>
                    <option value="nao">Não</option>
                </select>

                <label for="DP_performada" style="display: inline-block; width: 150px;">DP Performada?</label>
                <select id="DP_performada" class="content1" style="width: 200px; display: inline-block;" disabled>
                    <option value="">Selecione...</option>
                    <option value="sim">Sim</option>
                    <option value="nao">Não</option>
                </select>

                <label for="Limite_DP" style="display: inline-block; width: 150px;">Limite DP</label>
                <input type="text" id="Limite_DP" class="content1" style="width: 200px; display: inline-block;" disabled>

                <label for="tranche_DP" style="display: inline-block; width: 150px;">Tranche DP?</label>
                <input type="text" id="tranche_DP" class="content1" style="width: 200px; display: inline-block;" disabled>

                <label for="taxa_DP" style="display: inline-block; width: 150px;">Taxa DP?</label>
                <input type="text" id="taxa_DP" class="content1" style="width: 200px; display: inline-block;" disabled>

                <script>
                    function verificarDescontoDP() {
                        var descontoDP = document.getElementById("desconto_dp").value;
                        var camposObrigatorios = ["DP_performada", "Limite_DP", "tranche_DP", "taxa_DP"];

                        if (descontoDP === "sim") {
                            camposObrigatorios.forEach(function(campoId) {
                                document.getElementById(campoId).disabled = false;
                                document.getElementById(campoId).setAttribute("required", "required");
                            });
                        } else {
                            camposObrigatorios.forEach(function(campoId) {
                                document.getElementById(campoId).disabled = true;
                                document.getElementById(campoId).removeAttribute("required");
                                document.getElementById(campoId).value = ""; // Limpar o valor se estiver desabilitado
                            });
                        }
                    }
                </script>

            <label for="desconto_escrow" style="display: inline-block; width: 150px;">Desconto Escrow?</label>
            <select id="desconto_escrow" class="content1" style="width: 200px; display: inline-block;" onchange="verificarDescontoEscrow()">
                <option value="">Selecione...</option>
                <option value="Deposito C/C">Deposito C/C</option>
                <option value="Boletos">Boletos</option>
                <option value="Ambos">Ambos</option>
            </select>

            <label for="escrow_performada" style="display: inline-block; width: 150px;">Escrow Performada?</label>
            <select id="escrow_performada" class="content1" style="width: 200px; display: inline-block;" disabled>
                <option value="">Selecione...</option>
                <option value="sim">Sim</option>
                <option value="nao">Não</option>
            </select>

            <label for="limite_escrow_deposito" style="display: inline-block; width: 150px;">Limite para Escrow Deposito?</label>
            <input type="text" id="limite_escrow_deposito" class="content1" style="width: 200px; display: inline-block;" disabled>

            <label for="limite_escrow_boleto" style="display: inline-block; width: 150px;">Limite para Escrow Boleto?</label>
            <input type="text" id="limite_escrow_boleto" class="content1" style="width: 200px; display: inline-block;" disabled>

            <label for="escrow_taxa" style="display: inline-block; width: 150px;">Escrow Taxa?</label>
            <input type="text" id="escrow_taxa" class="content1" style="width: 200px; display: inline-block;" disabled>

            <label for="sacado" style="display: inline-block; width: 150px;">Sacado?</label>
            <input type="text" id="sacado" class="content1" style="width: 200px; display: inline-block;" disabled>

            <label for="garantia" style="display: inline-block; width: 150px;">Garantia?</label>
            <input type="text" id="garantia" class="content1" style="width: 200px; display: inline-block;" disabled>

            <script>
                function verificarDescontoEscrow() {
                    var descontoEscrow = document.getElementById("desconto_escrow").value;

                    var camposDeposito = ["limite_escrow_deposito", "escrow_taxa", "sacado", "garantia"];
                    var camposBoletos = ["escrow_performada", "limite_escrow_boleto", "escrow_taxa", "sacado", "garantia"];
                    var camposAmbos = ["escrow_performada", "limite_escrow_deposito", "limite_escrow_boleto", "escrow_taxa", "sacado", "garantia"];

                    function ativarCampos(campos) {
                        campos.forEach(function(campoId) {
                            document.getElementById(campoId).disabled = false;
                            document.getElementById(campoId).setAttribute("required", "required");
                        });
                    }

                    function desativarCampos(campos) {
                        campos.forEach(function(campoId) {
                            document.getElementById(campoId).disabled = true;
                            document.getElementById(campoId).removeAttribute("required");
                            document.getElementById(campoId).value = ""; // Limpar o valor se estiver desabilitado
                        });
                    }

                    // Desativar todos os campos antes de ativar os necessários
                    desativarCampos(camposDeposito.concat(camposBoletos, camposAmbos));

                    // Verificar qual opção foi selecionada e ativar os campos correspondentes
                    if (descontoEscrow === "Deposito C/C") {
                        ativarCampos(camposDeposito);
                    } else if (descontoEscrow === "Boletos") {
                        ativarCampos(camposBoletos);
                    } else if (descontoEscrow === "Ambos") {
                        ativarCampos(camposAmbos);
                    }
                }
            </script>
      </div>

            
             <!-- Coluna 2 - Todos os campos na mesma coluna -->
             <div class="section-title required" style="flex: 1;">
                 <!-- Intercompany -->
                 <label for="desconto_intercompany" style="display: inline-block; width: 150px;">Desconto Intercompany?</label>
                 <select id="desconto_intercompany" class="content1" style="width: 200px; display: inline-block;" onchange="verificarDescontoIntercompany()">
                     <option value="">Selecione...</option>
                     <option value="sim">Sim</option>
                     <option value="nao">Não</option>
                 </select>

                 <label for="limite_intercompany" style="display: inline-block; width: 150px;">Limite Intercompany</label>
                 <input type="text" id="limite_intercompany" class="content1" style="width: 200px; display: inline-block;" disabled>

                 <label for="taxa_intercompany" style="display: inline-block; width: 150px;">Taxa da Intercompany</label>
                 <input type="text" id="taxa_intercompany" class="content1" style="width: 200px; display: inline-block;" disabled>

                 <label for="prazo_intercompany" style="display: inline-block; width: 150px;">Prazo?</label>
                 <input type="text" id="prazo_intercompany" class="content1" style="width: 200px; display: inline-block;" disabled>

                 <label for="garantia_intercompany" style="display: inline-block; width: 150px;">Garantia?</label>
                 <input type="text" id="garantia_intercompany" class="content1" style="width: 200px; display: inline-block;" disabled>

                 <!-- Operação de Fomento -->
                 <label for="operação_fomento" style="display: inline-block; width: 150px; margin-top: 20px;">Operação de Fomento?</label>
                 <select id="operação_fomento" class="content1" style="width: 200px; display: inline-block;" onchange="verificarOperacaoFomento()">
                     <option value="">Selecione...</option>
                     <option value="sim">Sim</option>
                     <option value="nao">Não</option>
                 </select>

                 <label for="limite_fomento" style="display: inline-block; width: 150px;">Limite Fomento</label>
                 <input type="text" id="limite_fomento" class="content1" style="width: 200px; display: inline-block;" disabled>

                 <label for="taxa_fomento" style="display: inline-block; width: 150px;">Taxa do Fomento</label>
                 <input type="text" id="taxa_fomento" class="content1" style="width: 200px; display: inline-block;" disabled>

                 <label for="prazo_fomento" style="display: inline-block; width: 150px;">Prazo?</label>
                 <input type="text" id="prazo_fomento" class="content1" style="width: 200px; display: inline-block;" disabled>

                 <label for="garantia_fomento" style="display: inline-block; width: 150px;">Garantia?</label>
                 <input type="text" id="garantia_fomento" class="content1" style="width: 200px; display: inline-block;" disabled>

                 <!-- Demais Pleito -->
                 <label for="demais_pleito" style="display: inline-block; width: 150px; margin-top: 20px;">Demais Pleito?</label>
                 <input type="text" id="demais_pleito" class="content1" style="width: 200px; display: inline-block;">

                 <!-- Float das Operações -->
                 <label for="float_operacoes" style="display: inline-block; width: 150px;">Float das Operações?</label>
                 <select id="float_operacoes" class="content1" style="width: 200px; display: inline-block;">
                     <option value="">Selecione...</option>
                     <option value="D+1">D+1</option>
                     <option value="D+2">D+2</option>
                     <option value="D+3">D+3</option>
                 </select>

                 <!-- Custo DP -->
                 <label for="custo_dp" style="display: inline-block; width: 150px;">Custo DP?</label>
                 <input type="text" id="custo_dp" class="content1" style="width: 200px; display: inline-block;">

                 <!-- TED -->
                 <label for="ted" style="display: inline-block; width: 150px;">TED</label>
                 <input type="text" id="ted" class="content1" style="width: 200px; display: inline-block;">

                 <!-- TAC -->
                 <label for="tac" style="display: inline-block; width: 150px;">TAC</label>
                 <input type="text" id="tac" class="content1" style="width: 200px; display: inline-block;">
             </div>

             <script>
                 function verificarDescontoIntercompany() {
                     var descontoIntercompany = document.getElementById("desconto_intercompany").value;
                     var camposIntercompany = ["limite_intercompany", "taxa_intercompany", "prazo_intercompany", "garantia_intercompany"];

                     function ativarCampos(campos) {
                         campos.forEach(function(campoId) {
                             document.getElementById(campoId).disabled = false;
                             document.getElementById(campoId).setAttribute("required", "required");
                         });
                     }

                     function desativarCampos(campos) {
                         campos.forEach(function(campoId) {
                             document.getElementById(campoId).disabled = true;
                             document.getElementById(campoId).removeAttribute("required");
                             document.getElementById(campoId).value = ""; // Limpar o valor se estiver desabilitado
                         });
                     }

                     if (descontoIntercompany === "sim") {
                         ativarCampos(camposIntercompany);
                     } else {
                         desativarCampos(camposIntercompany);
                     }
                 }

                 function verificarOperacaoFomento() {
                     var operacaoFomento = document.getElementById("operação_fomento").value;
                     var camposFomento = ["limite_fomento", "taxa_fomento", "prazo_fomento", "garantia_fomento"];

                     function ativarCampos(campos) {
                         campos.forEach(function(campoId) {
                             document.getElementById(campoId).disabled = false;
                             document.getElementById(campoId).setAttribute("required", "required");
                         });
                     }

                     function desativarCampos(campos) {
                         campos.forEach(function(campoId) {
                             document.getElementById(campoId).disabled = true;
                             document.getElementById(campoId).removeAttribute("required");
                             document.getElementById(campoId).value = ""; // Limpar o valor se estiver desabilitado
                         });
                     }

                     if (operacaoFomento === "sim") {
                         ativarCampos(camposFomento);
                     } else {
                         desativarCampos(camposFomento);
                     }
                 }
             </script>


          </div>
         <h2>Fotos da Visita, por favor, anexar na POC</h2>
                    <div class="buttons">
                        <button type="button" onclick="validateAndPrint()">Imprimir Relatório</button>
                    </div>

                    <script>
                        function validateAndPrint() {
                            // Seleciona todos os inputs e selects que são obrigatórios em todas as etapas
                            const requiredFields = document.querySelectorAll('.required + input, .required + select,.required input,required select');
                            let missingFields = [];

                            // Verifica cada campo obrigatório
                            requiredFields.forEach(function(field) {
                                if (field.value.trim() === '') {
                                    field.classList.add('error-border');
                missingFields.push(field.previousElementSibling.textContent.replace(" *", ""));
                                } else {
                                    field.classList.remove('error-border');
                                }
                            });

                            if (missingFields.length > 0) {
                                alert('Por favor, preencha os seguintes campos:\n' + missingFields.join('\n'));
                            } else {
                                // Se todos os campos obrigatórios estiverem preenchidos, permitir a impressão
                                window.print();
                            }
                        }
                    </script>



                    <div class="footer">
                        <p>© 2024 Criado por André Luis Salles Martins. Todos os direitos reservados.</p>
                    </div>
                    </body>
                    </html>